### 4442 式接触卡隐写

话不多说，直接上题（攻防世界）

![](https://pic1.imgdb.cn/item/67f2730c0ba3d5a1d7eed711.png)

下载得到 logicdata 格式文件

![](https://pic1.imgdb.cn/item/67f273ee0ba3d5a1d7eed79d.png)

可以看到有时钟电平clk和数据电平data。查4442卡手册可以得知指令格式为：

1. 每个指令从时钟高电平时数据下降沿后开始，数据从低位到高位的顺序发送

   每个命令由三个字节组成：控制字节、地址字节、数据字节。时钟高电平数据电平上升沿代表本次命令结束

2. 与加密密钥相关的指令类型是 0x33，用于校验口令

   而 4442 卡的口令为三字节

因此我们需要找到这样一串数据：

```
0x33 0x01 flag[1] 0x33 0x02 flag[2] 0x33 0x03 flag[3]
```

在 6s950ms 处找到这串数据：

![](https://pic1.imgdb.cn/item/67f274ee0ba3d5a1d7eed82c.png)

第一段

![](https://pic1.imgdb.cn/item/67f275100ba3d5a1d7eed83f.png)

因此密钥的第一个字节是 0x40

重点是在时钟电平找到开始和结束标志（表现为一个较宽的峰），然后从数据电平按从高到低读取数据

第二段和第三段就在第一段后，各相隔 3 位以此类推得到 flag

```
SCTF{403110}
```

